         nam   NitrOS9         ttl   os9 system module* Disassembled 2014/10/29 16:00:37 by Disasm v1.5 (C) 1988 by RML         ifp1         use   /dd/defs/os9defs         endctylg     set   Systm+$07atrv     set   ReEnt+revrev      set   $04         mod   eom,name,tylg,atrv,start,sizeu0000    rmb   0size     equ   .name     fcs   /NitrOS9/         fcb   $01start    ldd   #$10FF         std   >$0000         ldd   #$0008         std   >$0002         ldd   #$20FE         std   >$0004         ldu   #$0124         leax  >L0124,pcr         ldy   #$0660L0032    lbsr  L00AC         tstb         beq   L003C         stb   ,y+         bra   L0032L003C    ldd   <D.BtSz      get boot size         subr  u,d         swi2               F$VBlock         fcb   $57         ldx   <D.SysDAT         ldb   $0D,x         incb         lda   #$01         ldx   <D.BlkMapL004D    sta   ,x+         decb         bne   L004D         ldx   <D.BlkMap         sta   <$3F,x         ldx   <D.SysMem         ldd   #$0140         leax  <$20,xL005F    sta   ,x+         decb         bne   L005F         ldd   <D.BtSz         subr  u,d         std   <D.BtSz         ldd   <D.BtPtr         addr  u,d         pshs  b,a         tfr   u,d         subd  #$00FF         ldx   <u004E         ldb   <D.BtPtr         abxL007C    clr   ,x+         deca         bne   L007C         bra   L00A6         leax  -$01,x         tfr   x,d         lsra         lsra         lsra         lsra         lsra         ldb   <u0036         lsrb         lsrb         lsrb         lsrb         lsrb         subr  b,a         beq   L00A6         ldu   <u0040         ldx   <u004C         lslb         incb         abxL009F    ldb   ,x++         clr   b,u         deca         bne   L009FL00A6    puls  b,a         std   <u0036         clrb         rtsL00AC    pshs  u,y,x,bL00AE    ldd   ,x         cmpd  #$87CD       module?         bne   L00C8        no,         ldd   M$Name,x         ldd   d,x         cmpd  #$5F65       _e? _end module         beq   L00C8        yes,         ldd   M$Size,x     get module size         leax  d,x         leau  d,u         bra   L00AEL00C8    ldy   $01,s        get module pointer         tfr   u,w         subw  $05,s         cmpw  #$3FC0         bcc   L011E         ldd   $02,x         leax  d,x         leau  d,u         stx   $01,s         stu   $05,s         ldb   #$02         os9   F$AllRAM         std   >$0642         stb   >$FFA1         stb   ,s         incb         std   >$0644         stb   >$FFA2         pshsw         ldx   #$2040         tfm   y+,x+         puls  b,a         ldx   #$2040         swi2         fcb   $57 W        F$VBlock         addd  #$013F         ldx   #$2000         ldb   #$3FL010C    clr   b,x         decb         bpl   L010C         ldb   #$01L0113    stb   ,x+         deca         bne   L0113         lda   #$2D         jsr   <u005E         puls  pc,u,y,x,bL011E    clrb         puls  pc,u,y,x,a         emodeom      equ   *L0124    equ   *         end